<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Chore Tracker</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <header>
      <h1>Chore Tracker</h1>
      <!-- This div will display the login status -->
      <div id="user-status">Checking login status...</div>
    </header>

    <div class="container">
      <h2>Welcome to Chore Tracker</h2>
      <p>
        <a href="/register.html">Register</a> |
        <a href="/login.html">Login</a> 
        <!--<a href="/chores.html">View Chores</a>-->
      </p>
    </div>

    <footer>
      <p>Mason Rauschkolb CS361 Winter 2025</p>
    </footer>

    <script>
      // Fetch the user info from the server to determine login status.
      fetch('/api/user')
        .then(response => response.json())
        .then(data => {
          const userStatusDiv = document.getElementById('user-status');
          if (data.user) {
            userStatusDiv.textContent =
              "Logged in as: " + data.user.username + " (" + data.user.role + ")";
          } else {
            userStatusDiv.textContent = "Logged out";
          }
        })
        .catch(error => {
          console.error("Error fetching user info:", error);
          document.getElementById('user-status').textContent = "Logged out";
        });
    </script>
  </body>
</html>
